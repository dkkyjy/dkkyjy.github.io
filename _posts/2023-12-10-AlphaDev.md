# AlphaDev

## New algorithms will transform the foundations of computing

数字社会正在推动对计算和能源使用的不断增加的需求。在过去的五十年中，我们依靠硬件的改进来保持步伐。但随着微芯片接近其物理极限，改善在其上运行的代码以使计算更强大和可持续变得至关重要。这对于构成每天运行数万亿次的代码的算法尤其重要。

在今天发表在《自然》杂志上的论文中，我们介绍了AlphaDev，一种使用强化学习发现增强计算机科学算法的人工智能（AI）系统 - 超越了科学家和工程师几十年来磨练的那些算法。

AlphaDev发现了一种更快的排序算法，一种用于对数据进行排序的方法。数十亿人每天都在使用这些算法，却不知道它们的存在。从在线搜索结果和社交媒体帖子的排名到计算机和手机上数据的处理方式，这些算法都发挥着基础性作用。使用人工智能生成更好的算法将改变我们编写计算机程序的方式，并影响我们日益数字化社会的所有方面。

通过将我们的新排序算法开源到主要的C++库中，全球数百万开发人员和公司现在将其用于从云计算和在线购物到供应链管理的各行业的AI应用程序。这是十多年来对排序库的这一部分进行的第一个改变，也是第一次将通过强化学习设计的算法添加到此库中。我们将此视为使用AI优化世界代码的重要垫脚石，一次一个算法。

## What is sorting?

排序是将一系列项目按照特定顺序组织起来的方法。例如，将三个字母按字母顺序排列，将五个数字从大到小排列，或对数百万条记录的数据库进行排序。

这种方法在历史上不断演变。最早的一个例子可以追溯到公元二世纪和三世纪，当时学者们手动将数千本书按字母顺序排列在亚历山大图书馆的书架上。随着工业革命的到来，发明了可以帮助排序的机器 - 制表机将信息存储在穿孔卡片上，这些卡片被用于收集1890年美国人口普查的结果。

随着20世纪50年代商用计算机的兴起，我们看到了最早的计算机科学排序算法的发展。今天，有许多不同的排序技术和算法被用于世界各地的代码库中，以组织在线的大量数据。

当代算法需要计算机科学家和程序员数十年的研究才能开发出来。它们非常高效，进一步提高效率是一个重大挑战，类似于寻找节省电力的新方法或更有效的数学方法。这些算法也是计算机科学的基石，在大学的计算机科学入门课程中教授。

## Searching for new algorithms

AlphaDev通过从零开始而不是改进现有算法来发现更快的算法，并开始研究大多数人不会去的地方：计算机的汇编指令。

汇编指令用于为计算机创建二进制代码以执行。虽然开发人员使用C ++等高级编程语言编写代码，但必须将其翻译成计算机可以理解的“低级”汇编指令。

我们认为在这个较低级别可能存在许多难以在高级编程语言中发现的改进。计算机存储和操作在这个级别上更加灵活，这意味着有更多潜在的改进可能会对速度和能源使用产生更大的影响。

代码通常用高级编程语言编写，如C ++。然后使用编译器将其翻译成低级CPU指令，称为汇编指令。然后，汇编器将汇编指令转换为计算机可以运行的可执行机器代码。

## Finding the best algorithms with a game

AlphaDev基于AlphaZero，这是我们在围棋、国际象棋和将棋等游戏中击败世界冠军的强化学习模型。通过AlphaDev，我们展示了这个模型如何从游戏转移到科学挑战，以及从模拟到现实世界的应用中。

为了训练AlphaDev发现新的算法，我们将排序转化为单人“汇编游戏”。在每个回合中，AlphaDev观察它生成的算法和中央处理单元（CPU）中包含的信息。然后，它通过选择一条指令添加到算法中来玩一步。

这个汇编游戏非常困难，因为AlphaDev必须高效地搜索指令的大量可能组合，以找到一种可以排序且比当前最佳算法更快的算法。指令的可能组合数量类似于宇宙中的粒子数量或国际象棋和围棋游戏中可能的移动组合数量（分别为10^120和10^700）。而一个错误的移动可能会使整个算法无效。

随着算法的构建，一次一个指令，AlphaDev通过将算法的输出与预期结果进行比较来检查其是否正确。对于排序算法，这意味着无序的数字进入并正确排序的数字出来。我们奖励AlphaDev正确地对数字进行排序以及它快速高效地完成的速度和效率。AlphaDev通过发现正确、更快的程序赢得游戏。

## Discovering faster sorting algorithms

AlphaDev发现了新的排序算法，这些算法在LLVM libc++排序库中实现了改进，对于AlphaDev发现了新的排序算法，这些算法在LLVM libc++排序库中实现了改进，对于较短的序列提高了高达70%的速度，对于超过250,000个元素的序列提高了约1.7%的速度。

我们专注于改进三到五个元素短序列的排序算法。这些算法是最常用的算法之一，因为它们经常作为较大排序函数的一部分被多次调用。改进这些算法可以导致对任意数量项目的排序速度的整体提高。

为了使新的排序算法更易于人们使用，我们对算法进行了逆向工程，并将其翻译成C ++，这是开发人员使用的最受欢迎的编程语言之一。这些算法现在可以在LLVM libc++标准排序库中使用，被全球数百万开发人员和公司使用。

## Finding novel approaches

AlphaDev不仅发现了更快的算法，还揭示了新的方法。它的排序算法包含新的指令序列，每次应用时都可以节省一条指令。这可以产生巨大的影响，因为这些算法每天被使用数万亿次。

我们称这些为“AlphaDev交换和复制移动”。这种新颖的方法让人想起AlphaGo的“第37步”——一种违反直觉的棋步，震惊了观众并导致一位传奇的围棋选手落败。通过交换和复制移动，AlphaDev跳过一步以连接物品的方式看起来像是错误，但实际上是一种捷径。这表明AlphaDev能够发现原始解决方案，并挑战我们对如何改进计算机科学算法的思考方式。


## From sorting to hashing in data structures

在发现更快的排序算法之后，我们测试了AlphaDev是否能够推广并改进另一种计算机科学算法：哈希。

哈希是计算中用于检索、存储和压缩数据的基本算法。就像图书馆管理员使用分类系统来查找特定书籍一样，哈希算法帮助用户知道他们正在寻找什么以及确切的位置在哪里。这些算法接受特定键的数据（例如用户名“Jane Doe”）并将其哈希化——将原始数据转换为唯一字符串的过程（例如1234ghfty）。计算机使用此哈希来快速检索与键相关的数据，而不是搜索所有数据。

我们将AlphaDev应用于数据结构中最常用于哈希的算法之一，以尝试发现更快的算法。当我们将其应用于哈希函数的9-16字节范围时，AlphaDev发现的算法快了30%。

今年，AlphaDev的新哈希算法发布到了开源Abseil库中，可供全球数百万开发人员使用，我们估计现在每天被使用数万亿次。

## Optimising the world’s code, one algorithm at a time

通过优化和推出改进的排序和哈希算法，AlphaDev展示了其泛化和发现具有实际影响的新算法的能力。我们将AlphaDev视为开发通用AI工具的一步，这些工具可以帮助优化整个计算生态系统并解决其他有益于社会的问题。

虽然在低级汇编指令空间中的优化非常强大，但随着算法的增长，存在一些限制，我们目前正在探索AlphaDev直接在高级语言（如C ++）中优化算法的能力，这将对开发人员更有用。

AlphaDev的发现，例如交换和复制移动，不仅表明它可以改进算法，还可以找到新的解决方案。我们希望这些发现能够激发研究人员和开发人员创造技术和方法，进一步优化基本算法，以创建更强大和可持续的计算生态系统。
