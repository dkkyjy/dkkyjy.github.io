# MuZero

2016年，我们推出了AlphaGo，这是第一个在古老的围棋游戏中击败人类的人工智能程序。它的后续版本AlphaZero和MuZero分别代表了通用算法追求中的一次重大进展，掌握更多的游戏，甚至不需要预先定义的知识。例如，MuZero掌握了国际象棋、围棋、将棋和Atari游戏，而无需被告知规则。但到目前为止，这些代理只专注于解决游戏问题。现在，为了实现DeepMind解决智能问题的使命，MuZero通过优化YouTube上的视频迈出了掌握现实世界任务的第一步。

在arXiv上预发布的一篇论文中，我们详细介绍了与YouTube的合作，以探索MuZero改善视频压缩的潜力。分析人士预测，流媒体视频将在2021年占据互联网流量的绝大部分。随着COVID-19大流行期间视频激增以及未来互联网流量总量的增长，视频压缩变得越来越重要，也是应用强化学习（RL）来改进挑战性领域中现有技术的自然领域。自从将一部分YouTube直播流量上线生产以来，我们在大量不同种类的视频中展示了平均4％的比特率降低。

大多数在线视频依赖于一种称为编解码器的程序，在源处压缩或编码视频，通过互联网将其传输给观众，然后对其进行解压缩或解码以进行播放。这些编解码器对视频中的每个帧做出多个决策。几十年的手工优化已经将这些编解码器优化到最佳状态，它们负责许多现在在互联网上可用的视频体验，包括视频点播、视频通话、视频游戏和虚拟现实。然而，由于RL特别适合于编解码器等顺序决策问题，因此我们正在探索RL学习算法如何提供帮助。

我们最初的重点是VP9编解码器（具体来说是开源版本libvpx），因为它被YouTube和其他流媒体服务广泛使用。与其他编解码器一样，使用VP9的服务提供者需要考虑比特率（即发送视频的每一帧所需的1和0的数量）。比特率是确定提供服务和存储视频所需的计算能力和带宽的主要因素，影响从视频加载时间到其分辨率、缓冲和数据使用的所有方面。

在VP9中，比特率通过速率控制模块中的量化参数（QP）最直接地进行优化。对于每个帧，此参数确定要应用的压缩级别。给定目标比特率，视频帧的QP将依次决定以最大化整体视频质量。直观地说，应该为复杂场景分配更高的比特率（更低的QP），而为静态场景分配更低的比特率（更高的QP）。QP选择算法推断一个视频帧的QP值如何影响其余视频帧的比特率分配和整体视频质量。RL在解决这种顺序决策问题方面特别有帮助。

MuZero通过将搜索能力与学习环境模型和相应计划的能力相结合，实现了超越人类表现的多种任务。这在大型组合动作空间中尤其有效，使其成为视频压缩中速率控制问题的理想候选解决方案。然而，要让MuZero在这个真实世界应用程序上工作需要解决一整套新的问题。例如，上传到YouTube等平台的视频集内容和质量各不相同，任何代理都需要在所有视频之间进行泛化，包括部署后的全新视频。相比之下，棋盘游戏往往只有一个已知的环境。许多其他指标和限制会影响最终用户体验和比特率节省，例如PSNR（峰值信噪比）和比特率限制。

为了解决MuZero面临的这些挑战，我们创建了一个称为自我竞争的机制，通过将代理当前的表现与其历史表现进行比较，将视频压缩的复杂目标转化为简单的WIN/LOSS信号。这使得我们可以将一组丰富的编解码器要求转化为一个简单的信号，以便我们的代理进行优化。

通过学习视频编码的动态并确定如何最好地分配比特，我们的MuZero Rate-Controller（MuZero-RC）能够在不降低质量的情况下减少比特率。QP选择是编码过程中众多编码决策之一。虽然几十年的研究和工程已经产生了高效的算法，但我们设想一个单一的算法可以自动学习做出这些编码决策以获得最优的速率失真权衡。

除了视频压缩之外，MuZero在研究环境之外的这个第一步是RL代理如何解决真实世界问题的一个例子。通过创建配备一系列新能力的代理来改进各个领域的产品，我们可以帮助企业和计算机系统更快、更少地使用资源，并更加自动化。我们的长期愿景是开发一种能够优化各种领域中数千个真实世界的系统的单一算法。
